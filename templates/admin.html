<!DOCTYPE html>
<html lang="ru">
<head>
  <title>Фильмотека — Администрирование</title>
  <meta charset="UTF-8">
  <link href="{{ url_for('static', filename='styles.css') }}" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
  <h1>Панель администратора фильмотеки</h1>
  <div class="accordion" id="adminAccordion">

    <!-- Фильмы -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingFilms">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFilms">
          Фильмы
        </button>
      </h2>
      <div id="collapseFilms" class="accordion-collapse collapse show">
        <div class="accordion-body">
          <table class="table">
            <thead>
              <tr><th>Название</th><th>Год</th><th>Режиссёр</th><th>Жанры</th><th>Действия</th></tr>
            </thead>
            <tbody>
              {% for f in films %}
              <tr>
                <td>{{ f[1] }}</td>
                <td>{{ f[2] }}</td>
                <td>{{ f[3] }}</td>
                <td>{{ ', '.join(f[4]) }}</td>
                <td>
                  <a class="btn btn-warning" href="/admin/edit_film/{{ f[0] }}">Редактировать</a>
                  <a class="btn btn-danger" href="/admin/delete_film/{{ f[0] }}">Удалить</a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Носители -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingCarriers">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCarriers">
          Носители
        </button>
      </h2>
      <div id="collapseCarriers" class="accordion-collapse collapse">
        <div class="accordion-body">
          <table class="table">
            <thead><tr><th>Тип</th><th>Фильм</th><th>Состояние</th><th>Цена</th><th>Режиссёр</th><th>Действия</th></tr></thead>
            <tbody>
              {% for c in carriers %}
              <tr>
                <td>{{ c[1] }}</td>
                <td>{{ c[4] }}</td>
                <td>{{ c[2] }}</td>
                <td>{{ c[3] }}</td>
                <td>{{ c[5] }}</td>
                <td>
                  <a class="btn btn-warning" href="/admin/edit_carrier/{{ c[0] }}">Редактировать</a>
                  <a class="btn btn-danger" href="/admin/delete_carrier/{{ c[0] }}">Удалить</a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Выдачи -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingIssues">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseIssues">
          Выдачи
        </button>
      </h2>
      <div id="collapseIssues" class="accordion-collapse collapse">
        <div class="accordion-body">
          <table class="table">
            <thead><tr>
              <th>Носитель</th><th>Пользователь</th><th>Дата выдачи</th><th>План. возврат</th><th>Факт</th><th>Статус</th><th>Действия</th>
            </tr></thead>
            <tbody>
              {% for i in issues %}
              <tr>
                <td>{{ i[8] }} ({{ i[9] }})</td>
                <td>{{ i[7] }}</td>
                <td>{{ i[3] }}</td>
                <td>{{ i[4] }}</td>
                <td>{{ i[5] or "-" }}</td>
                <td>{{ i[6] }}</td>
                <td>
                  <a class="btn btn-warning" href="/admin/edit_issue/{{ i[0] }}">Изменить</a>
                  <a class="btn btn-danger" href="/admin/delete_issue/{{ i[0] }}">Удалить</a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Пользователи -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingReaders">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseReaders">
          Пользователи
        </button>
      </h2>
      <div id="collapseReaders" class="accordion-collapse collapse">
        <div class="accordion-body">
          <table class="table">
            <thead>
              <tr>
                <th>ID</th><th>ФИО</th><th>Телефон</th><th>Дата регистрации</th><th>Статус</th><th>Действия</th>
              </tr>
            </thead>
            <tbody>
              {% for r in readers %}
              <tr>
                <td>{{ r[0] }}</td>
                <td>{{ r[1] }}</td>
                <td>{{ r[2] }}</td>
                <td>{{ r[3] }}</td>
                <td>{{ r[4] }}</td>
                <td>
                  <a class="btn btn-warning" href="/admin/edit_reader/{{ r[0] }}">Редактировать</a>
                  <a class="btn btn-danger" href="/admin/delete_reader/{{ r[0] }}">Удалить</a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Жанры -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingGenres">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseGenres">
          Жанры
        </button>
      </h2>
      <div id="collapseGenres" class="accordion-collapse collapse">
        <div class="accordion-body">
          <table class="table">
            <thead><tr><th>ID</th><th>Название</th><th>Действия</th></tr></thead>
            <tbody>
              {% for g in genres %}
              <tr>
                <td>{{ g[0] }}</td>
                <td>{{ g[1] }}</td>
                <td>
                  <a class="btn btn-warning" href="/admin/edit_genre/{{ g[0] }}">Редактировать</a>
                  <a class="btn btn-danger" href="/admin/delete_genre/{{ g[0] }}">Удалить</a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Режиссёры -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingDirectors">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseDirectors">
          Режиссёры
        </button>
      </h2>
      <div id="collapseDirectors" class="accordion-collapse collapse">
        <div class="accordion-body">
          <table class="table">
            <thead><tr><th>ID</th><th>ФИО</th><th>Действия</th></tr></thead>
            <tbody>
              {% for d in directors %}
              <tr>
                <td>{{ d[0] }}</td>
                <td>{{ d[1] }}</td>
                <td>
                  <a class="btn btn-warning" href="/admin/edit_director/{{ d[0] }}">Редактировать</a>
                  <a class="btn btn-danger" href="/admin/delete_director/{{ d[0] }}">Удалить</a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>

  </div>
</div>
</body>
</html>
